# Лабораторная работа 7-8. Объектная модель и ООП. Классы, поля и методы. Волшебные методы, переопределение методов. Наследование. Модель исключений

Классы в Python используются для создания собственных моделей, объединяя в одном месте данные и логику работы с ними. Они помогают структурировать код, делать его понятнее и удобнее для повторного использования.

Модель исключений нужна для обработки ошибок и неожиданных ситуаций во время выполнения программы. Она позволяет отделить обычный код от логики обработки ошибок, делая программы более надёжными и контролируемыми.

## Порядок выполнения

1. Склонируйте репозиторий себе на компьютер
2. Повторите теорию к лабораторной работе в [theory.ipynb](theory.ipynb)
3. Выполните задание лабораторной работы
4. Отправьте изменения на GitHub

## Задание

В этой лабораторной работе вам необходимо написать собственный прототип интернет магазина. Это должно быть приложение с консольным интерфейсом и реализацией описанного функционала. Приложение должно отражать принципы DDD-архитектуры, но не обязательно должно полностью следовать ей.

## Подготовка

1. Вам потребуется виртуальное окружение **Python** и пакетный менеджер, например, **Pip**. Откройте папку проекта в IDE и создайте в ней виртуальное окружение.
2. Изучите заготовку приложения, которая находится в папке `src/`. Можно использовать ее, либо придумать собственную структуру. Главное, чтобы были отражены архитектурные принципы разделения по слоям.
3. После того как приложение будет готово, сохраните используемые библиотеки в файл `requirements.txt`. Для этого в папке проекта выполните:
   ```shell
   pip freeze > requirements.txt
   ```

## Архитектура

DDD-архитектура — это паттерн проектирования, при котором логика приложения разбивается на слои, которые располагаются относительно друг друга в определенном порядке зависимостей (подробное описание слоев можно посмотреть в одной из прошлых лабораторных работ):

- **Domain Layer** (сущности, модели, с которыми можно работать в приложении)
- **Application Layer** (сценарии использования, какие действия можно совершать в приложении)
- **Infrastructure Layer** (реализация сценариев использования — как именно реализовывается описанный функционал)
- **Presentation Layer** (UI, API, то, с чем взаимодействует пользователь)

Presentation Layer может только вызывать сценарии использования. Application Layer работает с сущностями/моделями, то есть Domain Layer и с инфраструктурой. В этой лабораторной работе можно импортировать классы инфраструктуры в Application Layer. Вообще, это запрещено, и существуют специальные порты для связи, но в этой работе данным принципом можно пренебречь, и реализовывать порты не нужно.

## Функционал приложения

Вам необходимо написать прототип интернет-магазина. У этого приложения должен быть консольный интерфейс с выбором действия, например:

```
Выберите действие:
1) Войти в систему
2) Посмотреть информацию о приложении
3) Выйти и завершить программу
```

Данные нужно хранить в CSV-таблицах.

Рантайм приложения уже есть. Он реализован при помощи бесконечного цикла. Изучите принципы его работы и выхода из программы.

Также в файле `src/global_state.py` находится специальный класс `GlobalState`. Это синглтон, который реализовывает глобальное состояние приложения. По факту, это словарь, с которым можно работать следующим образом:

```python
from global_state import GlobalState

app_state = GlobalState()

app_state["message"] = "Hello, World!"
print(app_state["message"])  # -> Hello, World!
```

В любом месте в приложении его можно импортировать, чтобы получить доступ к этому словарю. Так как это синглтон, то это будет один и тот же объект во всем приложении. Но обратите внимание, что глобальное состояние потребуется только в интерфейсе пользователя. Остальные слои не должны от него зависеть.

### 1. Авторизация

У каждого пользователя должно быть свои имя, пароль, почта и баланс. Добавление пользователя реализовывать не нужно, можете заполнить таблицу пользователей вручную и работать с ней.

В приложении должна быть страница авторизации, в ней должно быть минимум два действия — войти в систему и закрыть приложение.

При выборе входа в систему приложение должно запросить логин и пароль и провести авторизацию. Если данные неверные, то должна быть выведена ошибка. Если все верно, то пользователь должен попасть на страницу личного кабинета.

При выборе выхода из системы необходимо полностью завершить программу.

### 2. Личный кабинет

В личном кабинете необходимо отразить информацию о текущем пользователе — логин, почту и баланс. Также должны быть действия перехода на страницу магазина и выхода из учетной записи. При выходе из учетной записи, пользователя должно перенести на страницу авторизации.

### 3. Страница магазина

На странице магазина необходимо отразить ассортимент товаров и их цены. Ассортимент должен браться из CSV-таблиц. Заполнить их нужно тоже вручную. Интерфейс должен быть примерно следующий (сильно много товаров добавлять не нужно, 7-10 будет достаточно):

```
Выберите товар:
1) Колбаса (200 руб.)
2) Шампунь (362 руб.)
...
```

При выборе продукта должна производиться проверка, хватает ли у пользователя денег и производиться покупка. Если у пользователя денег не хватает, вывести сообщение об этом. Если хватает, то вывести сообщение о том, что товар успешно приобретен и совершить покупку. Покупка происходит следующим образом — у пользователя просто уменьшается баланс и все. Закрепление товара за пользователем реализовывать не нужно. Последним (или нулевым до выбора, это на ваш вкус) в ассортименте должен быть пункт «вернуться в личный кабинет».
